<section class="task-page" data-controller="task">
  <div class="row">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <div class="d-flex align-items-center">
        <span class="text-muted mr-3">
          <i class="fas fa-check-square mr-1"></i>
          <%= @task.slug.upcase %>
        </span>
        <span class="badge rounded-pill <%= @task.label.color %>"><%= @task.label.name %></span>
      </div>
      <%= link_to 'Back to board', project_path(@project) %>
    </div>
    <div class="col-md-8">
      <header class="task-page__header mb-4">
        <h2 class="font-weight-bold"><%= @task.title %></h2>
      </header>
      <div>
        <%= @task.description %>
      </div>
      <div class="mt-4" data-controller="forms">
        <h4 class="font-weight-bold mb-3">Comments</h4>
        <div>
          <%= render 'comments/form' %>
        </div>
        <div class="mt-3">
          <% if @task.comments.any? %>
            <div data-target="forms.content">
              <%= render @task.comments %>
            </div>
          <% else %>
            <h5 class="text-center mt-3">Be the first adding a comment! ðŸ˜ƒ</h5>
          <% end %>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="bg-light rounded-lg p-2 mb-3">
        <%= label_tag 'Status', nil, { class: 'form-label font-weight-bold' } %>
        <%= select_tag "status",
              options_from_collection_for_select(@labels, 'slug', 'name', @task.label.slug),
              { class: 'form-select', data: { action: 'change->task#update_status' } } %>
      </div>
      <div class="task__assignee p-2 mb-3">
        <%= label_tag 'Assignee', nil, { class: 'form-label font-weight-bold' } %>
        <%= select_tag "assignee", options_from_collection_for_select(@members, 'id', 'name', @task.assignee&.id), { include_blank: 'Choose someone', class: 'form-select', data: { action: 'change->task#update_assignee' }} %>

        <% if @task.assignee %>
          <div class="mt-2">
            <a href="#" class="text-decoration-none">
              <%= render(UserAvatarComponent.new(user: @task.assignee, size: 30)) %>
            </a>
            <span class="ml-1"><%= @task.assignee.name.familiar %></span>
          </div>
        <% end %>
      </div>
      <div class="task__reporter p-2">
        <h6 class="font-weight-bold">Reporter</h6>
        <a href="#" class="text-decoration-none">
          <%= render(UserAvatarComponent.new(user: @task.reporter, size: 30)) %>
        </a>
        <span class="ml-1"><%= @task.reporter.name.familiar %></span>
      </div>
    </div>
  </div>
</section>
